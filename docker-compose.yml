services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "58000:8000"
    volumes:
      - ./backend:/app
      - ${SELF_HOME:-~/.self}:/root/.self:rw
      - ${SELF_HOME:-~/.self}/logs:/root/.self/logs:rw
    environment:
      - PYTHONUNBUFFERED=1
      - SELF_ENV=production
      - WECHAT_APPID=${WECHAT_APPID}
      - WECHAT_APPSECRET=${WECHAT_APPSECRET}
    restart: unless-stopped
